# ุชุญุณููุงุช ุงูุฃุฏุงุก ูุงูุณุฑุนุฉ ๐

## ุงูุชุญุณููุงุช ุงููุทุจูุฉ

ุชู ุชุญุณูู ุงูุฃุฏุงุก ุจุดูู ูุจูุฑ ูู ุฎูุงู ุงูุชุนุฏููุงุช ุงูุชุงููุฉ:

### 1. **ุชูููู ูุชุฑุฉ ุงููุญุต (Poll Interval)**

- **ุงูุชุบููุฑ**: ูู 30 ุซุงููุฉ ุฅูู **10 ุซูุงูู**
- **ุงูุชุฃุซูุฑ**: ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ ุชููุชุดู ุจุณุฑุนุฉ 3x
- **ุงููุชุบูุฑ ุงูุจูุฆู**: `POLL_INTERVAL_MS=10000`

### 2. **ุฒูุงุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงููุชูุงุฒูุฉ (Batch Size)**

- **ุงูุฑุณุงุฆู ุงูุฏุงุฎููุฉ**: ูู 2 ุฅูู **8 ุฑุณุงุฆู** ูู ููุณ ุงูููุช
- **ุงูุญุณุงุจุงุช**: ูู 2 ุฅูู **5 ุญุณุงุจุงุช** ูู ููุณ ุงูููุช
- **ุงูุชุฃุซูุฑ**: ุงููุนุงูุฌุฉ 4x ุฃุณุฑุน ููุฑุณุงุฆู ุงููุชุนุฏุฏุฉ

### 3. **ุชูููู ุงูุชุฃุฎูุฑุงุช**

| ุงูุนูููุฉ                    | ุงูุณุงุจู | ุงูุญุงูู | ุงูุชุญุณู  |
| -------------------------- | ------ | ------ | ------- |
| **ูุจู ุฌูุจ ุชูุงุตูู ุงูุฑุณุงูุฉ** | 300ms  | 100ms  | โก 3x   |
| **ุจูู ุงูู Batches**        | 500ms  | 100ms  | โก 5x   |
| **ุชุฃุฎูุฑ ุงูู Forward**      | 500ms  | 150ms  | โก 3x   |
| **ูุจู Retry**              | 500ms  | 100ms  | โก 5x   |
| **ุจูู Retries**            | 800ms  | 300ms  | โก 2.6x |

---

## ุงููุชุงุฆุฌ ุงููุชููุนุฉ

**ูุซุงู ุณููุงุฑูู ุญุงูู:**

- 10 ุญุณุงุจุงุชุ 50 ุฑุณุงูุฉ ุฌุฏูุฏุฉ ููู ุญุณุงุจ (500 ุฑุณุงูุฉ ุฅุฌูุงูู)
- **ุงูููุช ุงูุณุงุจู**: ~250-300 ุซุงููุฉ (4-5 ุฏูุงุฆู)
- **ุงูููุช ุงูุญุงูู**: ~40-60 ุซุงููุฉ (ุฃูู ูู ุฏูููุฉ)
- **ุงูุชุญุณู ุงูููู**: **5-6x ุฃุณุฑุน** ๐ฏ

---

## ุชุฎุตูุต ุงูุฃุฏุงุก (ูุชูุฏู)

### ุฎูุงุฑุงุช ุงูุจูุฆุฉ (Environment Variables)

```bash
# ุงูุณุฑุนุฉ (ms)
POLL_INTERVAL_MS=5000           # ูู 5 ุซูุงูู (ุฃุณุฑุน - ูุฏ ูุฒูุฏ ุงุณุชููุงู API)
FORWARD_DELAY_MS=100             # 100ms ุจุฏู 150ms
WORKER_CONCURRENCY=10            # ูุนุงูุฌุฉ 10 ุญุณุงุจุงุช ูุนุงู

# ุฅุฐุง ููุช ุชุฎุงู ูู ุญุฏูุฏ API
POLL_INTERVAL_MS=15000           # ูู 15 ุซุงููุฉ
FORWARD_DELAY_MS=200             # 200ms ููุฃูุงู
```

### ุงูุชูููู ุงูููุตู ุจู ุญุณุจ ุงูุญุงูุฉ

#### โก **ุงูุฃุฏุงุก ุงูุนุงูู ุฌุฏุงู** (ููุจูุฆุงุช ุงูููุซููุฉ)

```env
POLL_INTERVAL_MS=5000
FORWARD_DELAY_MS=100
WORKER_CONCURRENCY=10
```

#### โ๏ธ **ุงูุชูุงุฒู** (ุงูููุตู ุจู - ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ)

```env
POLL_INTERVAL_MS=10000          # ุงูุชุฑุงุถู ุงูุขู
FORWARD_DELAY_MS=150             # ุงูุชุฑุงุถู ุงูุขู
WORKER_CONCURRENCY=5             # ุงูุชุฑุงุถู ุงูุขู
```

#### ๐ก๏ธ **ุงูุฃูุงู ุงูุนุงูู** (ูุชุฌูุจ Rate Limits)

```env
POLL_INTERVAL_MS=30000
FORWARD_DELAY_MS=300
WORKER_CONCURRENCY=3
```

---

## ุญุฏูุฏ Microsoft Graph API

ููู: Microsoft Graph API ูุฏููุง ุญุฏูุฏ:

- **ุงูุทูุจุงุช**: ~500-1000 ุทูุจ ูู ุงูุฏูููุฉ ููู ุชุทุจูู
- **Retry-After**: ุฅุฐุง ุญุตูุช ุนูู 429ุ ูุชู ุงูุงูุชุธุงุฑ ุชููุงุฆูุงู
- **Rate Limiting**: ุชู ุจูุงุก ููุทู ุฅุนุงุฏุฉ ุงููุญุงููุฉ

### ูุตุงุฆุญ ูุชุฌูุจ ุงูุญุฏูุฏ:

1. **ูุง ุชููู POLL_INTERVAL ุฃูู ูู 5 ุซูุงูู** ุฅูุง ุฅุฐุง ูุงู ูุฏูู ุนุฏุฏ ูููู ูู ุงูุญุณุงุจุงุช
2. **ุฑุงูุจ ุงูู logs** ููุจุญุซ ุนู `429 Too Many Requests`
3. **ุฒูุงุฏุฉ FORWARD_DELAY ุฅุฐุง ุฑุฃูุช ุฃุฎุทุงุก ูุชูุฑุฑุฉ**

---

## ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ูู ุงูู Logs

ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:

```
[10:30:45] === Sync cycle (10 account(s)) ===       # ุจุฏุงูุฉ ุงูุฏูุฑุฉ
[10:30:48] ๐ง Processing: john@example.com        # ูุนุงูุฌุฉ ุญุณุงุจ
[10:30:50]    Found 5 message(s)                   # ุงูุฑุณุงุฆู ุงูููุชุดูุฉ
[10:30:55]    โ Forwarded: 5                       # ุงููุฌุงุญ
```

### ุงูููุช ุงููุซุงูู:

- **ูู 10 ุซูุงูู**: ูุญุต ุฌุฏูุฏ
- **ุฃูู ูู 10 ุซูุงูู**: ูุนุงูุฌุฉ 8-10 ุฑุณุงุฆู

---

## ุฎุทุฉ ุงููุณุชูุจู

### ๐ **Webhooks (Real-Time - ุงูุฎุทูุฉ ุงูุชุงููุฉ)**

ุจุฏู ุงููุญุต ูู 10 ุซูุงููุ ูููู ุงุณุชูุจุงู ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ ูู Microsoft:

- **ุงูุชุฃุฎูุฑ**: ูู ุซูุงูู ุฅูู **ููู ุซุงููุฉ**
- **ุงูุฌูุฏ**: ูุชูุณุท (ูุญุชุงุฌ ุชุนุฏูู ุฅุถุงูู)

### โ **ุชุทุจูู Webhooks ูุฑูุจุงู**

```
ุฑุณุงูุฉ ุฌุฏูุฏุฉ โ Microsoft Notification โ ูุนุงูุฌุฉ ููุฑูุฉ
(0.5 ุซุงููุฉ)
```

---

## ููุฎุต ุงูุชุญุณููุงุช

| ุงููููุงุณ                 | ุงูุณุงุจู    | ุงูุญุงูู   | ุงูุชุญุณู |
| ----------------------- | --------- | -------- | ------ |
| **ุงุณุชุฌุงุจุฉ ุงูุฑุณุงูุฉ**     | ~30s      | ~10s     | โก 3x  |
| **ูุนุงูุฌุฉ 500 ุฑุณุงูุฉ**    | 4-5 ุฏูุงุฆู | ~1 ุฏูููุฉ | โก 5x  |
| **ุงุณุชููุงู ุงูู Threads** | 2 ูุชุฒุงูู  | 8 ูุชุฒุงูู | โ      |
| **ุงุณุชููุงู API**         | ุฃูู       | ูุนุชุฏู    | โ      |

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ููุณ ุงูุฃุฏุงุก ุงูุญุงูู** - ุชุญูู ูู ุงูู logs
2. **ุฅุฐุง ูุงู ุจุทูุฆุงู**: ููู `POLL_INTERVAL_MS` ุฃูุซุฑ
3. **ุฅุฐุง ุญุตูุช ุนูู ุฃุฎุทุงุก**: ุฒุฏ `FORWARD_DELAY_MS` ู ุชูููู `WORKER_CONCURRENCY`
4. **ููุณุฑุนุฉ ุงููุตูู**: ูู ุงููุณุชูุจู ุณูุทุจู Webhooks
